<!DOCTYPE html>
<html lang="ru">
<head>
   <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N5KDBPR7CD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-N5KDBPR7CD');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –ò–ù–ù - Checko API</title>
    <style>
        :root {
            --color-primary: #208084;
            --color-primary-hover: #1a6670;
            --color-text: #133c3b;
            --color-bg: #fcfcf9;
            --color-surface: #ffffff;
            --color-border: #d4d4d0;
            --color-error: #c01531;
            --color-success: #208084;
            --color-warning: #ff9800;
            --radius-md: 8px;
            --space-16: 16px;
            --space-20: 20px;
        }

        * { box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: var(--space-20);
            background-color: var(--color-bg);
            color: var(--color-text);
        }

        .container { max-width: 1000px; margin: 0 auto; }

        h1 {
            font-size: 28px;
            margin: 0 0 var(--space-20) 0;
            text-align: center;
            color: var(--color-text);
        }

        .form-group { margin-bottom: var(--space-20); }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: var(--color-text);
        }

        .input-wrapper { display: flex; gap: 8px; }

        input[type="text"] {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            font-size: 14px;
            color: var(--color-text);
            background-color: var(--color-surface);
            transition: border-color 200ms;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(32, 128, 132, 0.1);
        }

        button {
            padding: 10px 20px;
            background-color: var(--color-primary);
            color: #ffffff;
            border: none;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 200ms;
            white-space: nowrap;
        }

        button:hover { background-color: var(--color-primary-hover); }
        button:active { opacity: 0.9; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }

        .tabs {
            display: flex;
            gap: 8px;
            margin: var(--space-20) 0;
            border-bottom: 2px solid var(--color-border);
        }

        .tab-button {
            padding: 8px 16px;
            background: none;
            border: none;
            color: var(--color-text);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            transition: all 200ms;
        }

        .tab-button.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .loading {
            text-align: center;
            padding: var(--space-20);
            color: var(--color-primary);
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(32, 128, 132, 0.2);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .result-card {
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--space-20);
            margin-top: var(--space-20);
        }

        .result-section { margin-bottom: var(--space-20); }
        .result-section:last-child { margin-bottom: 0; }

        .section-title {
            font-weight: 600;
            color: var(--color-primary);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            border-bottom: 1px solid var(--color-border);
            padding-bottom: 8px;
        }

        .result-item { margin-bottom: 12px; }
        .result-item:last-child { margin-bottom: 0; }

        .label {
            font-weight: 600;
            color: var(--color-text);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.7;
        }

        .value {
            font-size: 15px;
            margin-top: 4px;
            color: var(--color-text);
            word-break: break-word;
        }

        .error {
            background-color: rgba(192, 21, 31, 0.1);
            border: 1px solid var(--color-error);
            color: var(--color-error);
            padding: var(--space-16);
            border-radius: var(--radius-md);
            margin-top: var(--space-20);
            font-size: 14px;
        }

        .success {
            background-color: rgba(32, 128, 132, 0.1);
            border: 1px solid var(--color-success);
            color: var(--color-success);
            padding: var(--space-16);
            border-radius: var(--radius-md);
            margin-top: var(--space-20);
            font-size: 14px;
        }

        .warning {
            background-color: rgba(255, 152, 0, 0.1);
            border: 1px solid var(--color-warning);
            color: #e65100;
            padding: var(--space-16);
            border-radius: var(--radius-md);
            margin-top: var(--space-20);
            font-size: 13px;
        }

        .divider {
            height: 1px;
            background-color: var(--color-border);
            margin: var(--space-20) 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--space-20);
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        th {
            background-color: rgba(32, 128, 132, 0.1);
            color: var(--color-primary);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            border-bottom: 2px solid var(--color-border);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid var(--color-border);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: rgba(32, 128, 132, 0.05);
        }

        .year-cell {
            text-align: center;
            font-weight: 600;
            color: var(--color-primary);
        }

        .count-cell {
            text-align: center;
            background-color: rgba(32, 128, 132, 0.05);
        }

        .no-data {
            text-align: center;
            padding: var(--space-20);
            color: #999;
            font-style: italic;
        }

        .status-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-active {
            background-color: #c8e6c9;
            color: #2e7d32;
        }

        .status-liquidated {
            background-color: #ffccbc;
            color: #d84315;
        }

        .debug-panel {
            background-color: #f5f5f5;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: var(--space-16);
            margin-top: var(--space-20);
            font-size: 12px;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
        }

        .debug-log {
            margin-bottom: 4px;
            color: #666;
        }

        .debug-log.info { color: #2196F3; }
        .debug-log.success { color: #4CAF50; }
        .debug-log.error { color: #f44336; }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã, –≤–∏–¥–∏–º—ã–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ */
        .print-only {
            display: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ */
        @media print {
            h1, .form-group, .tabs, .tab-button, #printBtn, #content, #debug-tab {
                display: none !important;
            }
            #info-tab, #report-tab {
                display: block !important;
            }
            .print-only {
                display: block !important;
                margin-bottom: 10px;
            }
            .result-card {
                break-inside: avoid;
                border: 1px solid #ccc;
            }
            /* –£–±–∏—Ä–∞–µ–º –≤–µ—Ä—Ö–Ω–∏–π –æ—Ç—Å—Ç—É–ø —É –ø–µ—Ä–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ */
            #info-tab .result-card:first-of-type,
            #report-tab .result-card:first-of-type {
                margin-top: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè¢ –ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–ø–∞–Ω–∏–∏ / –ò–ü</h1>
        
        <div class="form-group">
            <label for="inn">–ò–ù–ù –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –ò–ü</label>
            <div class="input-wrapper">
                <input 
                    type="text" 
                    id="inn" 
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù (10 –∏–ª–∏ 12 —Ü–∏—Ñ—Ä)"
                    maxlength="12"
                >
                <button onclick="searchCompany()">–ü–æ–∏—Å–∫</button>
            </div>
        </div>

        <div class="tabs" id="tabs" style="display: none;">
            <button class="tab-button" onclick="switchTab('info')">üìã –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
            <button class="tab-button" onclick="switchTab('report')">üìä –û—Ç—á—ë—Ç</button>
            <button class="tab-button" onclick="switchTab('debug')">üîç –û—Ç–ª–∞–¥–∫–∞</button>
        </div>

        <div id="info-tab" class="tab-content active"></div>
        <div id="report-tab" class="tab-content"></div>
        <div id="debug-tab" class="tab-content"></div>
        <div id="content"></div>
    </div>

    <script>
        const API_KEY = 'QQuLenE1LVuotYiF';
        const API_URL = 'https://api.checko.ru/v2/company';
        const LEGAL_CASES_URL = 'https://api.checko.ru/v2/legal-cases';
        const FINANCES_URL = 'https://api.checko.ru/v2/finances';
        const ENFORCEMENTS_URL = 'https://api.checko.ru/v2/enforcements';
        let debugLogs = [];
        let currentINN = '';
        let currentOGRN = '';
        let currentCompanyData = null; // –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø–µ—á–∞—Ç–∏

        // –î–∞–Ω–Ω—ã–µ —Å—É–¥–æ–≤, —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤
        let casesRecords = null;
        let casesLoaded = false;
        let financialData = null;
        let financialsLoaded = false;
        let enforcementRecords = null;
        let enforcementsLoaded = false;

        function addDebugLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('ru-RU');
            debugLogs.push({ timestamp, message, type });
            console.log(`[${timestamp}] ${message}`);
            updateDebugPanel();
        }

        function updateDebugPanel() {
            const debugTab = document.getElementById('debug-tab');
            let debugHtml = '<div class="result-card"><strong>üîç –õ–æ–≥ –∑–∞–ø—Ä–æ—Å–æ–≤:</strong><br>';
            debugLogs.forEach(log => {
                const className = log.type === 'success' ? 'success' : log.type === 'error' ? 'error' : 'info';
                debugHtml += `<div class="debug-log ${className}">[${log.timestamp}] ${escapeHtml(log.message)}</div>`;
            });
            debugHtml += '</div>';
            debugTab.innerHTML = debugHtml;
        }

        function validateINN(inn) {
            const cleaned = inn.replace(/\D/g, '');
            if (cleaned.length !== 10 && cleaned.length !== 12) return false;
            return /^\d{10}$|^\d{12}$/.test(cleaned);
        }

        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –ø–æ —Ç–µ–∫—Å—Ç—É
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => {
                if (tabName === 'info' && btn.textContent.includes('–û–±—â–∞—è')) {
                    btn.classList.add('active');
                } else if (tabName === 'report' && btn.textContent.includes('–û—Ç—á—ë—Ç')) {
                    btn.classList.add('active');
                } else if (tabName === 'debug' && btn.textContent.includes('–û—Ç–ª–∞–¥–∫–∞')) {
                    btn.classList.add('active');
                }
            });
            
            if (tabName === 'report') {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É–¥—ã, –µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
                if (!casesLoaded) {
                    loadLegalCases(currentINN, currentOGRN);
                } else {
                    renderReportTab();
                }
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∏–Ω–∞–Ω—Å—ã, –µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
                if (!financialsLoaded) {
                    loadFinancials(currentOGRN, currentINN);
                } else {
                    renderReportTab();
                }
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, –µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
                if (!enforcementsLoaded) {
                    loadEnforcements(currentOGRN, currentINN);
                } else {
                    renderReportTab();
                }
            }
        }

        async function searchCompany() {
            const innInput = document.getElementById('inn');
            const inn = innInput.value.trim();
            debugLogs = [];

            // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
            casesRecords = null;
            casesLoaded = false;
            financialData = null;
            financialsLoaded = false;
            enforcementRecords = null;
            enforcementsLoaded = false;
            currentCompanyData = null;

            if (!inn) {
                document.getElementById('content').innerHTML = '<div class="error">‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –ò–ù–ù</div>';
                return;
            }

            if (!validateINN(inn)) {
                document.getElementById('content').innerHTML = '<div class="error">‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ò–ù–ù. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 10 –∏–ª–∏ 12 —Ü–∏—Ñ—Ä</div>';
                return;
            }

            currentINN = inn.replace(/\D/g, '');
            currentOGRN = '';
            document.getElementById('content').innerHTML = '<div class="loading"><div class="spinner"></div><p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p></div>';
            document.getElementById('info-tab').innerHTML = '';
            document.getElementById('report-tab').innerHTML = '';
            document.getElementById('debug-tab').innerHTML = '';
            document.getElementById('tabs').style.display = 'flex';
            
            addDebugLog(`–ó–∞–ø—Ä–æ—Å –ø–æ –ò–ù–ù: "${currentINN}"`);

            try {
                const url = `${API_URL}?key=${API_KEY}&inn=${currentINN}`;
                addDebugLog(`URL –∫–æ–º–ø–∞–Ω–∏–∏: ${url}`);

                const response = await fetch(url);
                addDebugLog(`HTTP —Å—Ç–∞—Ç—É—Å: ${response.status}`, response.ok ? 'success' : 'error');

                const responseText = await response.text();
                let data = JSON.parse(responseText);
                addDebugLog('JSON —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω', 'success');

                if (!data.data) {
                    document.getElementById('content').innerHTML = '<div class="error">‚ùå –ö–æ–º–ø–∞–Ω–∏—è –∏–ª–∏ –ò–ü –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –ø–æ –¥–∞–Ω–Ω–æ–º—É –ò–ù–ù</div>';
                    return;
                }

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –û–ì–†–ù –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥–µ–ª, —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤
                currentOGRN = data.data.–û–ì–†–ù || data.data.–û–ì–†–ù–ò–ü || '';
                addDebugLog(`–û–ì–†–ù —Å–æ—Ö—Ä–∞–Ω—ë–Ω: ${currentOGRN}`);

                addDebugLog('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ', 'success');
                currentCompanyData = data.data;
                displayCompanyInfo(data.data);
                document.getElementById('content').innerHTML = '';
                document.getElementById('tabs').style.display = 'flex';

            } catch (error) {
                addDebugLog(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ${error.message}`, 'error');
                document.getElementById('content').innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö: ${error.message}</div>`;
            }
        }

        async function loadFinancials(ogrn, inn) {
            if (financialsLoaded) return financialData;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É, –µ—Å–ª–∏ –≤–∫–ª–∞–¥–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞
            if (document.getElementById('report-tab').classList.contains('active')) {
                renderReportTab();
            }
            
            try {
                const params = ogrn ? `ogrn=${ogrn}` : `inn=${inn}`;
                const url = `${FINANCES_URL}?key=${API_KEY}&${params}`;
                addDebugLog(`–ó–∞–ø—Ä–æ—Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤: ${url}`);
                
                const response = await fetch(url);
                const text = await response.text();
                const data = JSON.parse(text);
                
                addDebugLog(`–§–∏–Ω–∞–Ω—Å—ã –ø–æ–ª—É—á–µ–Ω—ã, —Å—Ç–∞—Ç—É—Å: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (data.meta && data.meta.status === 'error') {
                    addDebugLog(`–û—à–∏–±–∫–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤: ${data.meta.message}`, 'error');
                    financialData = null;
                } else {
                    financialData = data;
                }
                financialsLoaded = true;
                
                if (document.getElementById('report-tab').classList.contains('active')) {
                    renderReportTab();
                }
                return financialData;
            } catch (e) {
                addDebugLog(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤: ${e.message}`, 'error');
                financialsLoaded = true;
                financialData = null;
                if (document.getElementById('report-tab').classList.contains('active')) {
                    renderReportTab();
                }
                return null;
            }
        }

        async function loadEnforcements(ogrn, inn) {
            enforcementsLoaded = false;
            renderReportTab(); // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä
            
            try {
                let allRecords = [];
                const pageSize = 100;
                let totalPages = 1;

                addDebugLog(`–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤ –ø–æ –ò–ù–ù: ${inn}`);

                // –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å
                const params = ogrn ? `ogrn=${ogrn}` : `inn=${inn}`;
                const firstUrl = `${ENFORCEMENTS_URL}?key=${API_KEY}&${params}&limit=${pageSize}&page=1`;
                addDebugLog(`–ó–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤ - page: 1, limit: ${pageSize}`);
                addDebugLog(`${firstUrl}`);

                const firstResponse = await fetch(firstUrl);
                const firstResponseText = await firstResponse.text();
                const firstData = JSON.parse(firstResponseText);
                
                addDebugLog(`HTTP —Å—Ç–∞—Ç—É—Å: ${firstResponse.status}`, 'info');

                if (firstData.data && firstData.data.–°—Ç—Ä–í—Å–µ–≥–æ) {
                    totalPages = firstData.data.–°—Ç—Ä–í—Å–µ–≥–æ;
                    addDebugLog(`–û–ø—Ä–µ–¥–µ–ª–µ–Ω–æ ${totalPages} —Å—Ç—Ä–∞–Ω–∏—Ü(—ã)`, 'success');
                }

                if (firstData.data && firstData.data.–ó–∞–ø–∏—Å–∏ && Array.isArray(firstData.data.–ó–∞–ø–∏—Å–∏)) {
                    allRecords = allRecords.concat(firstData.data.–ó–∞–ø–∏—Å–∏);
                    addDebugLog(`‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${firstData.data.–ó–∞–ø–∏—Å–∏.length} –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ 1. –í—Å–µ–≥–æ: ${allRecords.length}`, 'success');
                }

                // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                for (let page = 2; page <= totalPages; page++) {
                    try {
                        const url = `${ENFORCEMENTS_URL}?key=${API_KEY}&${params}&limit=${pageSize}&page=${page}`;
                        addDebugLog(`–ó–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤ - page: ${page}, limit: ${pageSize}`);
                        addDebugLog(`${url}`);

                        const response = await fetch(url);
                        const responseText = await response.text();
                        const data = JSON.parse(responseText);
                        
                        addDebugLog(`HTTP —Å—Ç–∞—Ç—É—Å: ${response.status}`, 'info');

                        if (data.data && data.data.–ó–∞–ø–∏—Å–∏ && Array.isArray(data.data.–ó–∞–ø–∏—Å–∏)) {
                            allRecords = allRecords.concat(data.data.–ó–∞–ø–∏—Å–∏);
                            addDebugLog(`‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.data.–ó–∞–ø–∏—Å–∏.length} –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ${page}. –í—Å–µ–≥–æ: ${allRecords.length}`, 'success');
                        }
                    } catch (e) {
                        addDebugLog(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ (page ${page}): ${e.message}`, 'error');
                    }
                }

                enforcementRecords = allRecords;
                enforcementsLoaded = true;
                addDebugLog(`–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í—Å–µ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${allRecords.length} –∑–∞–ø–∏—Å–µ–π`, 'success');
            } catch (error) {
                addDebugLog(`–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤: ${error.message}`, 'error');
                enforcementRecords = [];
                enforcementsLoaded = true;
            }
            renderReportTab();
        }

        async function loadLegalCases(inn, ogrn = '') {
            casesLoaded = false;
            renderReportTab(); // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä
            
            try {
                let allRecords = [];
                const pageSize = 100;
                let totalPages = 1;

                addDebugLog(`–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–µ–ª –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ –ø–æ –ò–ù–ù: ${inn}`);

                // –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å
                const firstUrl = `${LEGAL_CASES_URL}?key=${API_KEY}&inn=${inn}&date_from=2023-01-01&date_to=2025-12-31&page=1&limit=${pageSize}`;
                addDebugLog(`–ó–∞–ø—Ä–æ—Å —Å—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª - page: 1, limit: ${pageSize}`);
                addDebugLog(`${firstUrl}`);

                const firstResponse = await fetch(firstUrl);
                const firstResponseText = await firstResponse.text();
                const firstData = JSON.parse(firstResponseText);
                
                addDebugLog(`HTTP —Å—Ç–∞—Ç—É—Å: ${firstResponse.status}`, 'info');

                if (firstData.data && firstData.data.–°—Ç—Ä–í—Å–µ–≥–æ) {
                    totalPages = firstData.data.–°—Ç—Ä–í—Å–µ–≥–æ;
                    addDebugLog(`–û–ø—Ä–µ–¥–µ–ª–µ–Ω–æ ${totalPages} —Å—Ç—Ä–∞–Ω–∏—Ü(—ã), –≤—Å–µ–≥–æ ${firstData.data.–ó–∞–ø–í—Å–µ–≥–æ} –∑–∞–ø–∏—Å–µ–π`, 'success');
                }

                if (firstData.data && firstData.data.–ó–∞–ø–∏—Å–∏ && Array.isArray(firstData.data.–ó–∞–ø–∏—Å–∏)) {
                    allRecords = allRecords.concat(firstData.data.–ó–∞–ø–∏—Å–∏);
                    addDebugLog(`‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${firstData.data.–ó–∞–ø–∏—Å–∏.length} –¥–µ–ª –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ 1. –í—Å–µ–≥–æ: ${allRecords.length}`, 'success');
                }

                // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                for (let page = 2; page <= totalPages; page++) {
                    try {
                        const url = `${LEGAL_CASES_URL}?key=${API_KEY}&inn=${inn}&date_from=2023-01-01&date_to=2025-12-31&page=${page}&limit=${pageSize}`;
                        addDebugLog(`–ó–∞–ø—Ä–æ—Å —Å—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª - page: ${page}, limit: ${pageSize}`);
                        addDebugLog(`${url}`);

                        const response = await fetch(url);
                        const responseText = await response.text();
                        const data = JSON.parse(responseText);
                        
                        addDebugLog(`HTTP —Å—Ç–∞—Ç—É—Å: ${response.status}`, 'info');

                        if (data.data && data.data.–ó–∞–ø–∏—Å–∏ && Array.isArray(data.data.–ó–∞–ø–∏—Å–∏)) {
                            allRecords = allRecords.concat(data.data.–ó–∞–ø–∏—Å–∏);
                            addDebugLog(`‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.data.–ó–∞–ø–∏—Å–∏.length} –¥–µ–ª –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ${page}. –í—Å–µ–≥–æ: ${allRecords.length}`, 'success');
                        }
                    } catch (e) {
                        addDebugLog(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ (page ${page}): ${e.message}`, 'error');
                    }
                }

                casesRecords = allRecords;
                casesLoaded = true;
                addDebugLog(`–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í—Å–µ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${allRecords.length} –¥–µ–ª`, 'success');
            } catch (error) {
                addDebugLog(`–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª: ${error.message}`, 'error');
                casesRecords = [];
                casesLoaded = true;
            }
            renderReportTab();
        }

        function renderReportTab() {
            const tab = document.getElementById('report-tab');
            // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç—É –¥–ª—è –ø–µ—á–∞—Ç–∏
            const now = new Date();
            const dateStr = now.toLocaleString('ru-RU', { 
                day: 'numeric', month: 'long', year: 'numeric', 
                hour: '2-digit', minute: '2-digit', second: '2-digit' 
            });
            
            // –û—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –¥–∞—Ç–æ–π, –≤–∏–¥–∏–º–∞—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—á–∞—Ç–∏
            let html = `<div class="result-card print-only">
                <div class="section-title">üìÖ –î–∞—Ç–∞ –æ—Ç—á—ë—Ç–∞</div>
                <div class="value">${dateStr}</div>
            </div>`;

            // –ë–ª–æ–∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤
            if (financialsLoaded) {
                if (financialData && financialData.data) {
                    html += displayFinancials(financialData);
                } else {
                    html += '<div class="warning">‚ùå –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</div>';
                }
            } else {
                html += '<div class="loading"><div class="spinner"></div><p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...</p></div>';
            }

            // –ë–ª–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤
            if (enforcementsLoaded) {
                if (enforcementRecords && enforcementRecords.length > 0) {
                    html += displayEnforcements(enforcementRecords);
                } else {
                    html += '<div class="no-data">üìã –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                }
            } else {
                html += '<div class="loading"><div class="spinner"></div><p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤...</p></div>';
            }

            // –ë–ª–æ–∫ —Å—É–¥–æ–≤
            if (casesLoaded) {
                if (casesRecords && casesRecords.length > 0) {
                    html += displayLegalCases(casesRecords);
                } else {
                    html += '<div class="no-data">üìã –°—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                }
            } else {
                html += '<div class="loading"><div class="spinner"></div><p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª...</p></div>';
            }

            // –ö–Ω–æ–ø–∫–∞ –ø–µ—á–∞—Ç–∏
            html += '<div style="text-align: center; margin-top: 20px;">';
            html += '<button id="printBtn" onclick="printReport()" class="no-print">üìÑ –í—ã–≥—Ä—É–∑–∏—Ç—å –æ—Ç—á—ë—Ç –≤ PDF</button>';
            html += '</div>';

            tab.innerHTML = html;
        }

        function displayEnforcements(records) {
            // –ü–æ–¥—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –Ω–µ–ø–æ–≥–∞—à–µ–Ω–Ω—ã–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞–º (–û—Å—Ç–ó–∞–¥–æ–ª–∂ > 0)
            let count = 0;
            let totalSum = 0;
            records.forEach(rec => {
                const ost = rec.–û—Å—Ç–ó–∞–¥–æ–ª–∂;
                if (ost && ost > 0) {
                    count++;
                    totalSum += ost;
                }
            });

            let html = '<div class="result-card">';
            html += '<div class="section-title">‚öñÔ∏è –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</div>';
            if (count === 0) {
                html += '<div class="no-data">–ù–µ—Ç –Ω–µ–ø–æ–≥–∞—à–µ–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤</div>';
            } else {
                html += `<div class="result-item">
                    <div class="label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø–æ–≥–∞—à–µ–Ω–Ω—ã—Ö</div>
                    <div class="value">${count}</div>
                </div>`;
                html += `<div class="result-item">
                    <div class="label">–û–±—â–∞—è —Å—É–º–º–∞ –Ω–µ–ø–æ–≥–∞—à–µ–Ω–Ω–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏</div>
                    <div class="value">${formatNumber(Math.round(totalSum))} ‚ÇΩ</div>
                </div>`;
            }
            html += '</div>';
            return html;
        }

        function displayFinancials(finData) {
            const data = finData.data;
            if (!data) return '<div class="warning">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ñ–∏–Ω–∞–Ω—Å–∞—Ö</div>';
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –≥–æ–¥—ã, —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é, –±–µ—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3
            const years = Object.keys(data)
                .filter(y => /^\d{4}$/.test(y))
                .map(Number)
                .sort((a, b) => a - b)
                .slice(-3);
            
            if (years.length === 0) return '<div class="warning">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã</div>';
            
            let html = '<div class="result-card">';
            html += '<div class="section-title">üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</div>';
            html += '<table>';
            html += '<thead><tr><th>–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>';
            years.forEach(year => {
                html += `<th class="year-cell">${year}</th>`;
            });
            html += '</tr></thead>';
            html += '<tbody>';
            
            // –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å (2110)
            html += '<tr>';
            html += '<td>–í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å (2110)</td>';
            years.forEach(year => {
                const val = data[year] && data[year]['2110'] ? data[year]['2110'] : null;
                html += `<td class="count-cell">${val !== null ? formatNumber(val) : '‚Äî'}</td>`;
            });
            html += '</tr>';
            
            // –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (2400)
            html += '<tr>';
            html += '<td>–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (2400)</td>';
            years.forEach(year => {
                const val = data[year] && data[year]['2400'] ? data[year]['2400'] : null;
                html += `<td class="count-cell">${val !== null ? formatNumber(val) : '‚Äî'}</td>`;
            });
            html += '</tr>';
            
            html += '</tbody></table>';
            
            // –£—Å—Ç–∞–≤–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥ (1310)
            const latestYear = years[years.length - 1]; // –ø–æ—Å–ª–µ–¥–Ω–∏–π (—Å–∞–º—ã–π –Ω–æ–≤—ã–π)
            const cap = latestYear && data[latestYear] && data[latestYear]['1310'] ? data[latestYear]['1310'] : null;
            html += '<div style="margin-top: 16px;">';
            html += '<div class="label">–£—Å—Ç–∞–≤–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª (–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—Ç—á—ë—Ç–Ω—É—é –¥–∞—Ç—É)</div>';
            html += `<div class="value">${cap !== null ? formatNumber(cap) + ' ‚ÇΩ' : '‚Äî'}</div>`;
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        function displayLegalCases(records) {
            addDebugLog(`–û–±—Ä–∞–±–æ—Ç–∫–∞ ${records.length} –∑–∞–ø–∏—Å–µ–π —Å—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª`, 'info');

            const statistics = {
                '–ò—Å—Ç–µ—Ü': { '2023': 0, '2024': 0, '2025': 0 },
                '–û—Ç–≤–µ—Ç—á–∏–∫': { '2023': 0, '2024': 0, '2025': 0 }
            };

            let processedCount = 0;

            records.forEach(record => {
                if (!record.–î–∞—Ç–∞) return;
                
                const year = record.–î–∞—Ç–∞.substring(0, 4);
                
                if (record.–ò—Å—Ç && Array.isArray(record.–ò—Å—Ç)) {
                    const isIstec = record.–ò—Å—Ç.some(ist => ist.–ò–ù–ù === currentINN);
                    if (isIstec && statistics['–ò—Å—Ç–µ—Ü'][year] !== undefined) {
                        statistics['–ò—Å—Ç–µ—Ü'][year]++;
                        processedCount++;
                    }
                }
                
                if (record.–û—Ç–≤–µ—Ç && Array.isArray(record.–û—Ç–≤–µ—Ç)) {
                    const isOtvetc = record.–û—Ç–≤–µ—Ç.some(ot => ot.–ò–ù–ù === currentINN);
                    if (isOtvetc && statistics['–û—Ç–≤–µ—Ç—á–∏–∫'][year] !== undefined) {
                        statistics['–û—Ç–≤–µ—Ç—á–∏–∫'][year]++;
                        processedCount++;
                    }
                }
            });

            addDebugLog(`–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–µ–ª: ${processedCount}`, 'success');

            let html = '<div class="result-card">';
            html += '<div class="success">‚úì –î–∞–Ω–Ω—ã–µ —Å—É–¥–µ–±–Ω—ã—Ö –¥–µ–ª –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ</div>';
            html += '<div class="divider"></div>';
            
            html += '<table>';
            html += '<thead><tr>';
            html += '<th>–†–æ–ª—å</th>';
            html += '<th class="year-cell">2023</th>';
            html += '<th class="year-cell">2024</th>';
            html += '<th class="year-cell">2025</th>';
            html += '</tr></thead>';
            html += '<tbody>';

            Object.keys(statistics).forEach(role => {
                html += '<tr>';
                html += `<td><strong>${role}</strong></td>`;
                html += `<td class="count-cell">${statistics[role]['2023']}</td>`;
                html += `<td class="count-cell">${statistics[role]['2024']}</td>`;
                html += `<td class="count-cell">${statistics[role]['2025']}</td>`;
                html += '</tr>';
            });

            html += '</tbody></table>';
            html += '</div>';

            return html;
        }

        function displayCompanyInfo(company) {
            const isIP = !!company.–û–ì–†–ù–ò–ü || (!company.–ö–ü–ü && !company.–ù–∞–∏–º–ü–æ–ª–Ω);
            let title;
            if (isIP) {
                const fio = company.–§–ò–û || company.–ù–∞–∏–º–ü–æ–ª–Ω || company.–ù–∞–∏–º–°–æ–∫—Ä || '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å';
                title = `–ò–ü ${fio}`;
                addDebugLog('–û–ø—Ä–µ–¥–µ–ª—ë–Ω —Ç–∏–ø: –ò–ü', 'info');
            } else {
                title = company.–ù–∞–∏–º–ü–æ–ª–Ω || company.–ù–∞–∏–º–°–æ–∫—Ä || '–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è';
                addDebugLog('–û–ø—Ä–µ–¥–µ–ª—ë–Ω —Ç–∏–ø: —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ', 'info');
            }

            // –î–∞—Ç–∞ –¥–ª—è –ø–µ—á–∞—Ç–∏
            const now = new Date();
            const dateStr = now.toLocaleString('ru-RU', { 
                day: 'numeric', month: 'long', year: 'numeric', 
                hour: '2-digit', minute: '2-digit', second: '2-digit' 
            });

            let html = '<div class="result-card">';
            // –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞—Ç—É –≤–Ω—É—Ç—Ä—å –∫–∞—Ä—Ç–æ—á–∫–∏, –≤–∏–¥–∏–º—É—é —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—á–∞—Ç–∏
            html += `<div class="print-only" style="margin-bottom: 10px;"><strong>üìÖ –î–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á—ë—Ç–∞:</strong> ${dateStr}</div>`;
            html += '<div class="success">‚úì –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ</div>';
            html += '<div class="divider"></div>';

            html += '<div class="result-section">';
            html += '<div class="section-title">üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>';
            
            html += `<div class="result-item">
                <div class="label">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</div>
                <div class="value">${escapeHtml(title)}</div>
            </div>`;

            if (company.–ò–ù–ù) {
                html += `<div class="result-item">
                    <div class="label">–ò–ù–ù</div>
                    <div class="value">${escapeHtml(company.–ò–ù–ù)}</div>
                </div>`;
            }

            if (company.–ö–ü–ü && !isIP) {
                html += `<div class="result-item">
                    <div class="label">–ö–ü–ü</div>
                    <div class="value">${escapeHtml(company.–ö–ü–ü)}</div>
                </div>`;
            }

            if (company.–û–ì–†–ù && !isIP) {
                html += `<div class="result-item">
                    <div class="label">–û–ì–†–ù</div>
                    <div class="value">${escapeHtml(company.–û–ì–†–ù)}</div>
                </div>`;
            }

            if (company.–û–ì–†–ù–ò–ü && isIP) {
                html += `<div class="result-item">
                    <div class="label">–û–ì–†–ù–ò–ü</div>
                    <div class="value">${escapeHtml(company.–û–ì–†–ù–ò–ü)}</div>
                </div>`;
            }

            html += '</div>';

            html += '<div class="result-section">';
            html += '<div class="section-title">üìÖ –°—Ç–∞—Ç—É—Å –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>';

            if (company.–°—Ç–∞—Ç—É—Å && company.–°—Ç–∞—Ç—É—Å.–ù–∞–∏–º) {
                const statusClass = company.–°—Ç–∞—Ç—É—Å.–ù–∞–∏–º === '–î–µ–π—Å—Ç–≤—É–µ—Ç' ? 'status-active' : 'status-liquidated';
                html += `<div class="result-item">
                    <div class="label">–°—Ç–∞—Ç—É—Å</div>
                    <div class="value"><span class="status-badge ${statusClass}">${escapeHtml(company.–°—Ç–∞—Ç—É—Å.–ù–∞–∏–º)}</span></div>
                </div>`;
            }

            if (company.–î–∞—Ç–∞–†–µ–≥) {
                html += `<div class="result-item">
                    <div class="label">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                    <div class="value">${escapeHtml(company.–î–∞—Ç–∞–†–µ–≥)}</div>
                </div>`;
            }

            html += '</div>';

            // –ë–ª–æ–∫ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ –¥–ª—è —é—Ä–ª–∏—Ü)
            if (!isIP && company.–†—É–∫–æ–≤–æ–¥ && company.–†—É–∫–æ–≤–æ–¥.length > 0) {
                const director = company.–†—É–∫–æ–≤–æ–¥[0]; // –æ–±—ã—á–Ω–æ –ø–µ—Ä–≤—ã–π - –¥–∏—Ä–µ–∫—Ç–æ—Ä
                html += '<div class="result-section">';
                html += '<div class="section-title">üë§ –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</div>';
                
                html += `<div class="result-item">
                    <div class="label">–î–æ–ª–∂–Ω–æ—Å—Ç—å</div>
                    <div class="value">${escapeHtml(director.–ù–∞–∏–º–î–æ–ª–∂–Ω || director.–í–∏–¥–î–æ–ª–∂–Ω || '–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å')}</div>
                </div>`;
                
                html += `<div class="result-item">
                    <div class="label">–§–ò–û</div>
                    <div class="value">${escapeHtml(director.–§–ò–û)}</div>
                </div>`;
                
                if (director.–ú–∞—Å—Å–†—É–∫–æ–≤–æ–¥) {
                    html += `<div class="result-item">
                        <div class="label">–ü—Ä–∏–∑–Ω–∞–∫ –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è</div>
                        <div class="value"><span class="status-badge status-liquidated">–î–∞</span></div>
                    </div>`;
                }
                
                html += '</div>';
            }

            // –û–±—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫ –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if (!isIP && company.–ú–∞—Å—Å–†—É–∫–æ–≤–æ–¥) {
                html += '<div class="warning">‚ö†Ô∏è –í –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –º–∞—Å—Å–æ–≤—ã–µ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏</div>';
            }

            if (company.–Æ—Ä–ê–¥—Ä–µ—Å && company.–Æ—Ä–ê–¥—Ä–µ—Å.–ê–¥—Ä–µ—Å–†–§) {
                html += '<div class="result-section">';
                html += '<div class="section-title">üìç –ê–¥—Ä–µ—Å</div>';
                html += `<div class="result-item">
                    <div class="value">${escapeHtml(company.–Æ—Ä–ê–¥—Ä–µ—Å.–ê–¥—Ä–µ—Å–†–§)}</div>
                </div>`;
                html += '</div>';
            }

            if (company.–ö–æ–Ω—Ç–∞–∫—Ç—ã && (company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–¢–µ–ª || company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–ï–º—ç–π–ª)) {
                html += '<div class="result-section">';
                html += '<div class="section-title">üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</div>';
                
                if (company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–¢–µ–ª && company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–¢–µ–ª.length > 0) {
                    html += '<div class="result-item"><div class="label">–¢–µ–ª–µ—Ñ–æ–Ω—ã</div>';
                    company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–¢–µ–ª.slice(0, 3).forEach(tel => {
                        html += `<div style="font-size: 14px; margin-top: 4px;">‚òéÔ∏è ${escapeHtml(tel)}</div>`;
                    });
                    html += '</div>';
                }
                
                if (company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–ï–º—ç–π–ª && company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–ï–º—ç–π–ª.length > 0) {
                    html += '<div class="result-item"><div class="label">Email</div>';
                    company.–ö–æ–Ω—Ç–∞–∫—Ç—ã.–ï–º—ç–π–ª.slice(0, 3).forEach(email => {
                        html += `<div style="font-size: 14px; margin-top: 4px;">‚úâÔ∏è ${escapeHtml(email)}</div>`;
                    });
                    html += '</div>';
                }
                
                html += '</div>';
            }

            html += '</div>';
            document.getElementById('info-tab').innerHTML = html;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function printReport() {
            // –í—Ä–µ–º–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –æ–±–µ –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞)
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById('info-tab').classList.add('active');
            document.getElementById('report-tab').classList.add('active');
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—á–∞—Ç—å
            window.print();
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç—É –≤–∫–ª–∞–¥–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ –ø–µ—á–∞—Ç–∏)
            const activeButton = document.querySelector('.tab-button.active');
            if (activeButton) {
                const tabName = activeButton.textContent.includes('–û–±—â–∞—è') ? 'info' : 
                               (activeButton.textContent.includes('–û—Ç—á—ë—Ç') ? 'report' : 'debug');
                switchTab(tabName);
            } else {
                // –ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏, –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º info
                switchTab('info');
            }
        }

        document.getElementById('inn').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchCompany();
            }
        });
    </script>
</body>
</html>
